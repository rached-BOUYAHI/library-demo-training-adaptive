name: library-demo-training-adaptive

parameters:
  pool_id:
    type: int
    description: Pool index (1..N)

hosts:
  - name: server
    base_box:
      image: ubuntu-noble-x86_64
      man_user: ubuntu
    flavor: standard.small

  - name: client
    base_box:
      image: ubuntu-noble-x86_64
      man_user: ubuntu
    flavor: standard.small

routers:
  - name: router
    base_box:
      image: debian-12-x86_64
      man_user: debian
    flavor: standard.small

networks:
  - name: server-switch
    cidr: 10.20.${pool_id}.0/24
    accessible_by_user: false

  - name: client-switch
    cidr: 10.30.${pool_id}.0/24
    accessible_by_user: true

  - name: external-net
    external: true
    provider_network: base-net

net_mappings:
  - host: server
    network: server-switch
    ip: 10.20.${pool_id}.5

  - host: client
    network: client-switch
    ip: 10.30.${pool_id}.5

router_mappings:
  - router: router
    network: server-switch
    ip: 10.20.${pool_id}.1

  - router: router
    network: client-switch
    ip: 10.30.${pool_id}.1

  - router: router
    network: external-net
    nat: true
